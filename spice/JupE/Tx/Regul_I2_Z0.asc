Version 4
SHEET 1 2248 680
WIRE 1600 128 1568 128
WIRE 1968 128 1680 128
WIRE 1968 160 1968 128
WIRE 608 192 544 192
WIRE 864 192 688 192
WIRE 976 192 864 192
WIRE 544 240 544 192
WIRE 1568 240 1568 128
WIRE 864 256 864 192
WIRE 976 256 976 192
WIRE 1968 272 1968 240
WIRE 1568 368 1568 320
WIRE 1968 368 1968 352
WIRE 1968 368 1568 368
WIRE 1968 384 1968 368
WIRE 544 400 544 320
WIRE 752 400 544 400
WIRE 864 400 864 336
WIRE 864 400 752 400
WIRE 976 400 976 336
WIRE 976 400 864 400
FLAG 752 400 0
FLAG 864 192 E1
IOPIN 864 192 BiDir
FLAG 1968 384 0
FLAG 544 192 VB1
FLAG 1568 128 VB2
SYMBOL res 704 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL ind 960 240 R0
WINDOW 0 36 40 Invisible 2
WINDOW 3 35 52 Left 2
SYMATTR InstName L1
SYMATTR Value {Lp}
SYMBOL res 848 240 R0
WINDOW 0 36 40 Invisible 2
WINDOW 3 34 58 Left 2
SYMATTR InstName R3
SYMATTR Value {Rp}
SYMBOL bv 544 224 R0
WINDOW 3 -173 105 Left 2
SYMATTR Value V=Vgen(A,Fs)
SYMATTR InstName B1
SYMBOL res 1696 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {R1}
SYMBOL ind 1952 144 R0
WINDOW 0 36 40 Invisible 2
WINDOW 3 35 52 Left 2
SYMATTR InstName L2
SYMATTR Value {Ls}
SYMBOL res 1952 256 R0
WINDOW 0 36 40 Invisible 2
WINDOW 3 34 58 Left 2
SYMATTR InstName R4
SYMATTR Value {Rs}
SYMBOL bv 1568 224 R0
WINDOW 3 -173 105 Left 2
SYMATTR Value V=Vgen(A,Fs)
SYMATTR InstName B2
TEXT 560 440 Left 2 !.PARAM A=2.62 Fs=500 m=1/7
TEXT 608 8 Left 2 !.PARAM R1=0.38
TEXT 320 440 Left 2 !.tran 0 0.2 0 50u
TEXT 560 472 Left 2 !.func Vgen(A,f)={A*sin(2*pi*f*time)}
TEXT 1096 -24 Left 2 !.MEAS Rpv PARAM Rp \n.MEAS Lpv PARAM Lp\n.MEAS Rsv PARAM Rs\n.MEAS Lsv PARAM Ls\n.MEAS Ipg RMS I(B1) \n.MEAS Vpg RMS V(VB1)\n.MEAS Zpload PARAM Vpg/Ipg\n.MEAS Isg RMS I(B2) \n.MEAS Vsg RMS V(VB2)\n.MEAS Zsload PARAM Vsg/Isg
TEXT 608 40 Left 2 !.PARAM ModZ0=0.823 ArgZ0=0.387
TEXT 496 -72 Left 2 !.PARAM Rs=ModZ0*cos(ArgZ0)-R1 \n.PARAM Ls=ModZ0*sin(ArgZ0)/(2*pi*Fs)
TEXT 496 -176 Left 2 !.PARAM Rp=Eval_Rp(ModZ0,ArgZ0,R1,Fs)\n.PARAM Lp=Eval_Lp(ModZ0,ArgZ0,R1,Fs)
TEXT 520 -208 Left 2 !.INCLUDE func.txt
