Version 4
SHEET 1 2156 680
WIRE 608 192 544 192
WIRE 752 192 688 192
WIRE 864 192 752 192
WIRE 976 192 864 192
WIRE 752 208 752 192
WIRE 544 240 544 192
WIRE 864 256 864 192
WIRE 976 256 976 192
WIRE 752 304 752 288
WIRE 544 400 544 320
WIRE 752 400 752 384
WIRE 752 400 544 400
WIRE 864 400 864 336
WIRE 864 400 752 400
WIRE 976 400 976 336
WIRE 976 400 864 400
FLAG 752 400 0
FLAG 544 192 V1
IOPIN 544 192 Out
FLAG 752 192 E1
IOPIN 752 192 BiDir
SYMBOL res 704 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL res 736 192 R0
WINDOW 3 33 47 Left 2
WINDOW 0 36 40 Invisible 2
SYMATTR Value {R2}
SYMATTR InstName R2
SYMBOL ind 736 288 R0
WINDOW 0 37 75 Left 2
WINDOW 3 37 47 Left 2
SYMATTR InstName L2
SYMATTR Value {L2}
SYMBOL ind 960 240 R0
WINDOW 0 35 80 Left 2
WINDOW 3 35 52 Left 2
SYMATTR InstName L1
SYMATTR Value {Lp}
SYMBOL res 848 240 R0
WINDOW 0 36 40 Invisible 2
WINDOW 3 34 58 Left 2
SYMATTR InstName R3
SYMATTR Value {Rp}
SYMBOL bv 544 224 R0
WINDOW 3 -173 105 Left 2
SYMATTR Value V=Vgen(A,Fs)
SYMATTR InstName B1
TEXT 560 440 Left 2 !.PARAM A=0.093 Fs=500 m=1/7
TEXT 480 -8 Left 2 !.PARAM R1=0.38
TEXT 448 440 Left 2 !.tran 0.1
TEXT 560 472 Left 2 !.func Vgen(A,f)={A*sin(2*pi*f*time)}
TEXT 1128 152 Left 2 !.MEAS Rpv PARAM Rp \n.MEAS Lpv PARAM Lp\n.MEAS R2v PARAM R2\n.MEAS L2v PARAM L2\n.MEAS I2v RMS I(L2)/m\n.MEAS Igen RMS I(B1) \n.MEAS Vgen RMS V(V1)\n.MEAS Zload PARAM Vgen/Igen\n.MEAS V1v PARAM V1_c*sqrt(2)\n.MEAS Zeqv PARAM Zeq
TEXT 608 -176 Left 2 !.INCLUDE func.txt
TEXT 480 32 Left 2 !.PARAM ModZ0=0.823 ArgZ0=0.387\n.PARAM ModZ=0.594 ArgZ=0.318
TEXT 896 -120 Left 2 !.PARAM R2=Eval_R2(Rp,Lp,ModZ,ArgZ,R1,Fs)\n.PARAM L2=Eval_L2(Rp,Lp,ModZ,ArgZ,R1,Fs)
TEXT 1024 40 Left 2 !.PARAM V1_c=eval_V1(R2,L2,Rp,Lp,R1,Fs,1.2*0.5*m)\n.PARAM Zeq=ModZeq(R2,2*pi*Fs*L2,Rp,2*pi*Fs*Lp,R1)
TEXT 896 -48 Left 2 !.PARAM Rp=Eval_Rp(ModZ0,ArgZ0,R1,Fs)\n.PARAM Lp=Eval_Lp(ModZ0,ArgZ0,R1,Fs)
