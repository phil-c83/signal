Version 4
SHEET 1 3316 680
WIRE 1984 288 1920 288
WIRE 2128 288 2064 288
WIRE 2240 288 2128 288
WIRE 2352 288 2240 288
WIRE 2128 304 2128 288
WIRE 1920 336 1920 288
WIRE 2240 352 2240 288
WIRE 2352 352 2352 288
WIRE 2128 400 2128 384
WIRE 1920 496 1920 416
WIRE 2128 496 2128 480
WIRE 2128 496 1920 496
WIRE 2240 496 2240 432
WIRE 2240 496 2128 496
WIRE 2352 496 2352 432
WIRE 2352 496 2240 496
FLAG 2128 496 0
FLAG 1920 288 V1
IOPIN 1920 288 Out
FLAG 2128 288 E1
IOPIN 2128 288 BiDir
SYMBOL bv 1920 320 R0
WINDOW 3 -114 223 Left 2
SYMATTR InstName B1
SYMATTR Value V=sig_jup(time,1/410,1/440,{Eval_A(0.8,2/5)},2/5)
SYMBOL res 2080 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL res 2112 288 R0
WINDOW 3 33 47 Left 2
WINDOW 0 36 40 Invisible 2
SYMATTR Value {R2}
SYMATTR InstName R2
SYMBOL ind 2112 384 R0
WINDOW 0 37 75 Left 2
WINDOW 3 37 47 Left 2
SYMATTR InstName L1
SYMATTR Value {L2}
SYMBOL ind 2336 336 R0
WINDOW 0 35 80 Left 2
WINDOW 3 35 52 Left 2
SYMATTR InstName L2
SYMATTR Value {Lp}
SYMBOL res 2224 336 R0
WINDOW 0 36 40 Invisible 2
WINDOW 3 34 58 Left 2
SYMATTR InstName R3
SYMATTR Value {Rp}
TEXT 1808 480 Left 2 !.tran 0.1
TEXT 2520 -216 Left 2 !.param A1=coef_An(1,2/5,1)  A2=coef_An(1,2/5,2)\n.param B1=coef_Bn(1,2/5,1)  B2=coef_Bn(1,2/5,2)\n.param Ka=Eval_k(2/5) A=Eval_A(1,2/5)
TEXT 2536 40 Left 2 !.MEAS A1v param A1\n.MEAS A2v param A2\n.MEAS B1v param B1\n.MEAS B2v param B2\n.MEAS Kav param Ka\n.MEAS Av param A\n.MEAS V1rms RMS V(V1)
TEXT 1856 -224 Left 2 !.PARAM R1=0.38
TEXT 1856 -176 Left 2 !.PARAM ModZ0=0.823 ArgZ0=0.387\n.PARAM ModZ=0.594 ArgZ=0.318
TEXT 2904 40 Left 2 !.MEAS Rpv PARAM Rp \n.MEAS Lpv PARAM Lp\n.MEAS R2v PARAM R2\n.MEAS L2v PARAM L2\n.MEAS I2v RMS I(L2)/m\n.MEAS Igen RMS I(B1) \n.MEAS Zload PARAM Vgen/Igen\n.MEAS V1v PARAM V1_c*sqrt(2)\n.MEAS Zeqv PARAM Zeq
TEXT 2528 -104 Left 2 !.PARAM V1_c=eval_V1(R2,L2,Rp,Lp,R1,Fs,1.2*0.5*m)\n.PARAM Zeq=ModZeq(R2,2*pi*Fs*L2,Rp,2*pi*Fs*Lp,R1)
TEXT 1856 -88 Left 2 !.PARAM R2=Eval_R2(Rp,Lp,ModZ,ArgZ,R1,Fs)\n.PARAM L2=Eval_L2(Rp,Lp,ModZ,ArgZ,R1,Fs)
TEXT 1856 -24 Left 2 !.PARAM Rp=Eval_Rp(ModZ0,ArgZ0,R1,Fs)\n.PARAM Lp=Eval_Lp(ModZ0,ArgZ0,R1,Fs)
