Version 4
SHEET 1 2156 680
WIRE 608 192 544 192
WIRE 752 192 688 192
WIRE 864 192 752 192
WIRE 976 192 864 192
WIRE 752 208 752 192
WIRE 544 240 544 192
WIRE 864 256 864 192
WIRE 976 256 976 192
WIRE 752 304 752 288
WIRE 544 400 544 320
WIRE 752 400 752 384
WIRE 752 400 544 400
WIRE 864 400 864 336
WIRE 864 400 752 400
WIRE 976 400 976 336
WIRE 976 400 864 400
FLAG 752 400 0
FLAG 544 192 V1
IOPIN 544 192 Out
FLAG 752 192 E1
IOPIN 752 192 BiDir
SYMBOL res 704 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL res 736 192 R0
WINDOW 3 33 47 Left 2
WINDOW 0 36 40 Invisible 2
SYMATTR Value {Rs}
SYMATTR InstName R2
SYMBOL ind 736 288 R0
WINDOW 0 40 44 Left 2
SYMATTR InstName L1
SYMATTR Value {Ls}
SYMBOL ind 960 240 R0
SYMATTR InstName L2
SYMATTR Value {Lm}
SYMBOL res 848 240 R0
WINDOW 0 36 40 Invisible 2
SYMATTR InstName R3
SYMATTR Value {Rm}
SYMBOL bv 544 224 R0
WINDOW 3 -173 105 Left 2
SYMATTR Value V=Vgen(A,Fs)
SYMATTR InstName B1
TEXT 608 -88 Left 2 !.PARAM A=2.54 Fs=500 m=1/7
TEXT 608 8 Left 2 !.PARAM R1=0.38
TEXT 448 440 Left 2 !.tran 0.1
TEXT 608 -120 Left 2 !.func Vgen(A,f)={A*sin(2*pi*f*time)}
TEXT 1128 152 Left 2 !.MEAS Rmv PARAM Rm \n.MEAS Lmv PARAM Lm\n.MEAS Rsv PARAM Rs\n.MEAS Lsv PARAM Ls\n.MEAS I2v RMS I(L1)/m\n.MEAS Igen RMS I(B1) \n.MEAS Vgen RMS V(V1)\n.MEAS Zload PARAM Vgen/Igen\n.MEAS V1v PARAM V1_c\n.MEAS Zeqv PARAM Zeq
TEXT 608 -176 Left 2 !.INCLUDE func.txt
TEXT 608 40 Left 2 !.PARAM ModZm=0.81 ArgZm=0.4\n.PARAM ModZs=0.035 ArgZs=1.2
TEXT 608 -56 Left 2 !.PARAM Rm=ModZm/cos(ArgZm)-R1 Lm=ModZm/(2*pi*Fs*sin(ArgZm))\n.PARAM Rs=ModZs*cos(ArgZs) Ls=ModZs*sin(ArgZs)/(2*pi*Fs)
TEXT 1024 40 Left 2 !.PARAM V1_c=eval_V1(Rs,Ls,Rm,Lm,R1,m,Fs,0.5)\n.PARAM Zeq=ModZeq(Rs,2*pi*Fs*Ls,Rm,2*pi*Fs*Lm,R1,m)
